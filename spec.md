# Feature Specification: 寵物美容管理系統 (Pet Grooming Management System)
用戶端ID204165444234-rpsgtcu3hjifj7emj33mhl2abh5duba3.apps.googleusercontent.com
用戶端密碼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
**Feature Branch**: `001-pet-grooming-system`  
**Created**: 2025-12-01  
**Status**: Draft  
**Input**: 建立一個寵物美容的管理系統，第一階段功能包括：會員註冊、會員寵物資料管理、Checkin、收款、追加/變更服務、Checkout

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 會員註冊與登入 (Priority: P1)

顧客首次到店時，可透過註冊網頁輸入基本資料（姓名、手機號碼、密碼、email等）成為會員。系統使用手機號碼作為會員編號。註冊完成後，顧客可使用手機號碼與密碼登入系統管理個人資料。

**Why this priority**: 會員系統是整個寵物美容管理系統的基礎，沒有會員資料就無法進行後續的 Checkin、收款等流程。

**Independent Test**: 可透過完整的會員註冊流程測試，驗證新顧客能成功建立帳號並登入系統。

**Acceptance Scenarios**:

1. **Given** 顧客尚未註冊, **When** 顧客輸入有效的姓名、手機號碼、密碼與email並提交, **Then** 系統建立會員帳號，手機號碼成為會員編號，並導向登入頁面
2. **Given** 顧客已完成註冊, **When** 顧客使用手機號碼與密碼登入, **Then** 系統驗證成功後進入會員管理頁面
3. **Given** 顧客嘗試註冊, **When** 輸入已存在的手機號碼, **Then** 系統顯示該手機號碼已被註冊的提示訊息

---

### User Story 2 - 寵物資料管理 (Priority: P1)

會員可以新增、編輯、刪除名下的寵物資料。寵物資料包含寵物名稱、品種、性別、年齡、體重、特殊狀況等。店員也可透過輸入顧客手機號碼查詢並維護顧客與寵物資料。

**Why this priority**: 寵物資料是美容服務的核心對象，Checkin 流程需要寵物資料才能選擇服務項目。

**Independent Test**: 可透過新增一隻寵物並驗證資料正確儲存來獨立測試。

**Acceptance Scenarios**:

1. **Given** 會員已登入, **When** 會員新增寵物資料並填寫必要欄位後儲存, **Then** 系統儲存寵物資料並顯示在寵物清單中
2. **Given** 會員有寵物資料, **When** 會員編輯寵物資料並儲存, **Then** 系統更新寵物資料
3. **Given** 店員在店員端操作, **When** 店員輸入顧客手機號碼搜尋, **Then** 系統帶出該顧客的聯絡資料與所有寵物清單
4. **Given** 會員或店員嘗試編輯資料, **When** 嘗試變更手機號碼, **Then** 系統不允許變更並顯示提示訊息

---

### User Story 3 - 顧客 Checkin 流程 (Priority: P1)

顧客到店後掃描會員 QRCode，系統帶出會員資料與寵物清單。顧客選擇本次要美容的寵物與服務項目，確認後送至店員端。

**Why this priority**: Checkin 是服務流程的起點，建立訂單的必要步驟。

**Independent Test**: 可透過模擬顧客掃碼、選擇寵物與服務後確認送出來獨立測試。

**Acceptance Scenarios**:

1. **Given** 顧客到店並有有效會員 QRCode, **When** 顧客掃描 QRCode, **Then** 系統顯示顧客會員資料與名下寵物清單
2. **Given** 顧客已掃碼進入系統, **When** 顧客選擇本次美容的寵物與勾選服務項目後確認, **Then** 系統將服務清單送至店員端待確認
3. **Given** 顧客有多隻寵物, **When** 顧客選擇多隻寵物並分別選擇服務, **Then** 系統記錄每隻寵物各自的服務項目

---

### User Story 4 - 店員 Checkin 確認與檢查 (Priority: P1)

店員收到顧客的服務清單後，與顧客確認資料，檢查顧客自帶物品並建立清單，接著依 SOP 對寵物進行基本狀況檢查，完成後將資訊推送給顧客確認。

**Why this priority**: 店員確認與寵物檢查是服務開始前的必要把關步驟，確保雙方對服務內容與寵物狀況有共識。

**Independent Test**: 可透過店員接收一筆服務清單並完成物品與寵物檢查流程來獨立測試。

**Acceptance Scenarios**:

1. **Given** 店員收到顧客的服務清單, **When** 店員確認資料無誤, **Then** 系統允許店員進入物品檢查畫面
2. **Given** 店員在物品檢查畫面, **When** 店員輸入顧客自帶物品清單並儲存, **Then** 系統記錄物品清單
3. **Given** 店員完成物品檢查, **When** 店員依 SOP 檢查寵物狀況並點選檢查完成, **Then** 系統將檢查資訊推送至顧客端待確認
4. **Given** 有多隻寵物需檢查, **When** 店員完成所有寵物的檢查, **Then** 系統一併將所有寵物的檢查資訊送出

---

### User Story 5 - 合約簽署與訂單建立 (Priority: P1)

顧客確認點收清單與寵物狀況無誤後簽名確認。系統顯示定型化契約與本次美容項目合約（左右分割畫面），顧客簽名後系統建立訂單編號及各寵物的子訂單編號。

**Why this priority**: 合約簽署是法律保障的必要步驟，訂單建立是後續收款與服務追蹤的基礎。

**Independent Test**: 可透過顧客確認檢查結果並完成簽名流程，驗證訂單與子訂單編號正確建立。

**Acceptance Scenarios**:

1. **Given** 顧客收到店員推送的檢查資訊, **When** 顧客點選確認, **Then** 系統顯示合約簽署畫面（左側美容項目合約，右側定型化契約PDF）
2. **Given** 顧客在合約簽署畫面, **When** 顧客完成電子簽名並確認, **Then** 系統建立主訂單編號，並為每隻寵物建立子訂單編號
3. **Given** 訂單建立完成, **When** 店員端收到訂單資訊, **Then** 店員可選擇是否進行收款流程

---

### User Story 6 - 收款流程 (Priority: P1)

訂單建立後至完成前，店員可隨時查找訂單並進行收款。收款時顯示訂單詳情、待收總額與已收款紀錄。店員可輸入金額並選擇收款類別（訂金/預收款/尾款）。

**Why this priority**: 收款是營業收入的核心功能，影響店家現金流管理。

**Independent Test**: 可透過查詢一筆訂單並完成一筆收款紀錄來獨立測試。

**Acceptance Scenarios**:

1. **Given** 訂單已建立, **When** 店員點擊收款按鈕, **Then** 系統顯示訂單詳情、待收總額及已收款紀錄
2. **Given** 店員在收款畫面, **When** 店員輸入收款金額並選擇類別（訂金/預收款/尾款）後確認, **Then** 系統記錄此筆收款並更新待收總額
3. **Given** 店員完成收款, **When** 系統更新收款紀錄, **Then** 待收總額正確反映已收金額
4. **Given** Checkin 收款完成, **When** 店員選擇列印收執聯, **Then** 系統使用子訂單編號產生 QRCode 並列印收執聯

---

### User Story 7 - 追加/變更服務 (Priority: P2)

服務進行中，店員可隨時查找寵物訂單，聯繫顧客確認是否要追加或變更服務。追加項目須區分原始訂單項目與追加項目；變更項目須註記原服務取消及新增項目。

**Why this priority**: 追加服務是增加營收的重要功能，但需先有基本服務流程才能追加。

**Independent Test**: 可透過對現有訂單追加一個服務項目並驗證系統正確區分原始與追加項目來獨立測試。

**Acceptance Scenarios**:

1. **Given** 店員查找到寵物訂單, **When** 系統顯示訂單詳情, **Then** 同時顯示顧客聯繫方式供店員聯繫
2. **Given** 店員與顧客確認追加服務, **When** 店員在系統中新增服務項目, **Then** 系統將該項目標記為「追加項目」並計入訂單總額
3. **Given** 店員與顧客確認變更服務, **When** 店員取消原服務並新增替代服務, **Then** 系統註記原服務「已取消」並新增項目標記為「變更項目」
4. **Given** 訂單有異動項目, **When** Checkout 時, **Then** 系統產生訂單異動明細供顧客確認與收款

---

### User Story 8 - Checkout 流程 (Priority: P1)

顧客到店後掃描收執聯 QRCode，帶出寵物資訊並通知店員。店員將寵物帶出與顧客進行點交，確認自帶物品、寵物狀況與服務項目。若有多隻寵物則逐一進行。完成後進行結帳收款。

**Why this priority**: Checkout 是服務流程的終點，完成交付與收款的必要步驟。

**Independent Test**: 可透過模擬顧客掃碼、店員點交確認、顧客簽名至結帳完成的完整流程來獨立測試。

**Acceptance Scenarios**:

1. **Given** 顧客到店取寵物, **When** 顧客掃描收執聯 QRCode, **Then** 系統顯示寵物資訊並通知店員端
2. **Given** 店員收到通知, **When** 店員將寵物帶出, **Then** 系統顯示該子訂單的點交畫面（自帶物品、寵物狀況、服務項目）
3. **Given** 店員與顧客確認點交內容, **When** 確認無誤店員點選「已確認」, **Then** 系統將確認資訊送至顧客端待簽名
4. **Given** 店員與顧客有爭議, **When** 店員在畫面上註記爭議內容, **Then** 系統記錄爭議並仍可繼續流程
5. **Given** 顧客該筆訂單有多隻寵物, **When** 完成一隻寵物的點交, **Then** 系統自動帶出下一隻寵物的點交畫面
6. **Given** 全部寵物點交完成, **When** 系統進入結帳畫面, **Then** 顯示待收金額、折讓輸入欄位及最終應收金額
7. **Given** 店員完成結帳收款, **When** 顧客確認付款, **Then** 系統完成訂單並列印收據給顧客

---

### Edge Cases

- 顧客掃描 QRCode 但會員資料不存在或已停用時，系統應顯示錯誤訊息並引導至註冊頁面
- 顧客在 Checkin 過程中離開或逾時未完成時，系統應保留草稿狀態，允許重新繼續
- 寵物在服務過程中發生突發狀況需中止服務時，店員可標記「服務中止」並記錄原因
- 收款金額超過待收總額時，系統應提示並阻止操作
- 網路中斷時，顧客端與店員端的操作應能暫存，待網路恢復後同步
- 顧客在 Checkout 時拒絕簽名確認時，店員可標記「顧客拒簽」並記錄原因
- 收據列印失敗時，系統應允許重新列印

## Requirements *(mandatory)*

### Functional Requirements

**會員管理**
- **FR-001**: 系統必須允許顧客透過註冊網頁輸入姓名、手機號碼、密碼、email 等資料進行會員註冊
- **FR-002**: 系統必須使用手機號碼作為唯一會員編號
- **FR-003**: 系統必須驗證手機號碼格式有效且未被使用
- **FR-004**: 系統必須允許顧客使用手機號碼與密碼登入
- **FR-005**: 系統必須不允許會員或店員變更手機號碼

**寵物資料管理**
- **FR-006**: 系統必須允許每個會員建立多筆寵物資料
- **FR-007**: 寵物資料必須包含：名稱、品種、性別、年齡、體重、特殊狀況
- **FR-008**: 顧客端必須可維護自己的聯絡資料與寵物資料
- **FR-009**: 店員端必須可透過輸入手機號碼查詢顧客資料與寵物清單
- **FR-010**: 店員端必須可維護顧客的聯絡資料與寵物資料

**Checkin 流程**
- **FR-011**: 系統必須為每位會員產生專屬 QRCode
- **FR-012**: 顧客掃描 QRCode 後，系統必須顯示會員資料與寵物清單
- **FR-013**: 系統必須允許顧客選擇本次美容的寵物並勾選服務項目
- **FR-014**: 系統必須將顧客確認的服務清單傳送至店員端
- **FR-015**: 店員必須可建立顧客自帶物品清單
- **FR-016**: 店員必須可依 SOP 記錄寵物基本狀況檢查結果
- **FR-017**: 店員完成檢查後，系統必須將資訊推送至顧客端確認

**合約與訂單**
- **FR-018**: 系統必須顯示定型化契約與美容項目合約供顧客簽名（左右分割畫面）
- **FR-019**: 系統必須支援電子簽名功能
- **FR-020**: 顧客簽名確認後，系統必須建立訂單編號
- **FR-021**: 系統必須為每隻寵物建立獨立的子訂單編號
- **FR-022**: 系統必須使用子訂單編號產生 QRCode 作為收執聯

**收款**
- **FR-023**: 系統必須允許店員在訂單建立後至完成前隨時查找訂單進行收款
- **FR-024**: 收款畫面必須顯示訂單詳情、待收總額、已收款紀錄
- **FR-025**: 系統必須允許店員輸入收款金額並選擇類別（訂金/預收款/尾款）
- **FR-026**: 系統必須記錄每筆收款並即時更新待收總額
- **FR-027**: 系統必須可列印含 QRCode 的收執聯

**追加/變更服務**
- **FR-028**: 系統必須允許店員查找寵物訂單並顯示顧客聯繫方式
- **FR-029**: 系統必須區分「原始訂單項目」與「追加項目」
- **FR-030**: 系統必須可標記「已取消」的原服務項目與「變更項目」
- **FR-031**: 系統必須在 Checkout 時產生訂單異動明細

**Checkout**
- **FR-032**: 顧客掃描收執聯 QRCode 後，系統必須顯示寵物資訊並通知店員端
- **FR-033**: 系統必須顯示點交確認畫面（自帶物品、寵物狀況、服務項目）
- **FR-034**: 系統必須允許店員標記確認或註記爭議
- **FR-035**: 系統必須將確認資訊送至顧客端待簽名
- **FR-036**: 若有多隻寵物，系統必須逐一進行子訂單點交
- **FR-037**: 全部點交完成後，系統必須自動顯示結帳收款畫面
- **FR-038**: 系統必須支援折讓輸入並自動更新最終應收金額
- **FR-039**: 結帳完成後，系統必須完成訂單狀態並列印收據

### Key Entities

- **會員 (Member)**: 使用系統的顧客，以手機號碼為唯一識別，包含姓名、手機號碼、密碼、email、聯絡地址等基本資料，一位會員可擁有多隻寵物
- **寵物 (Pet)**: 屬於會員的寵物，包含名稱、品種、性別、年齡、體重、特殊狀況、照片等資料，一隻寵物隸屬於一位會員
- **訂單 (Order)**: 代表一次 Checkin 服務的主記錄，包含訂單編號、會員、訂單狀態、訂單總額、簽名檔案、建立時間等，一張訂單可包含多個子訂單
- **子訂單 (SubOrder)**: 代表單隻寵物的服務記錄，包含子訂單編號、所屬訂單、寵物、服務項目、物品清單、寵物檢查紀錄、點交狀態等
- **服務項目 (ServiceItem)**: 子訂單中的服務明細，包含服務名稱、金額、項目類型（原始/追加/變更）、取消狀態等
- **收款紀錄 (PaymentRecord)**: 訂單的收款記錄，包含金額、收款類別（訂金/預收款/尾款）、收款時間、收款方式等
- **物品清單 (ItemChecklist)**: 顧客自帶物品的記錄，包含物品名稱、數量、備註，屬於子訂單
- **寵物檢查紀錄 (PetCheckRecord)**: 店員對寵物的檢查記錄，包含檢查項目、檢查結果、備註，屬於子訂單

## Assumptions

- 手機號碼格式採用台灣手機號碼格式（09開頭10碼）
- 電子簽名以畫布觸控簽名方式實作，儲存為圖檔
- 定型化契約內容由店家預先設定並以 PDF 格式儲存
- 服務項目清單由店家預先設定，包含名稱與價格
- QRCode 包含會員編號或子訂單編號以供掃描識別
- 收執聯與收據支援印表機列印
- 顧客端與店員端為網頁介面，支援手機與平板操作
- 店員帳號與權限管理屬於基礎建設，本規格不詳述

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 顧客可在 3 分鐘內完成會員註冊流程
- **SC-002**: 店員輸入手機號碼後可在 2 秒內查詢到顧客與寵物資料
- **SC-003**: 顧客 Checkin 流程（掃碼至送出服務清單）可在 5 分鐘內完成
- **SC-004**: 店員完成物品與寵物檢查流程可在 10 分鐘內完成（每隻寵物）
- **SC-005**: 90% 的顧客可在首次使用時成功完成 Checkin 流程
- **SC-006**: 系統支援同時 50 位顧客與 10 位店員使用不發生明顯延遲
- **SC-007**: 訂單資料正確率達 99.9%（金額計算、項目記錄無誤）
- **SC-008**: 從 Checkin 完成到收執聯列印可在 1 分鐘內完成
- **SC-009**: Checkout 點交流程（每隻寵物）可在 5 分鐘內完成
- **SC-010**: 結帳完成到收據列印可在 30 秒內完成
